{"version":3,"sources":["arithmetic.js"],"names":["define","codec","QeTable","qe","nmps","nlps","switchFlag","arithmetic","ArithmeticDecoder","[object Object]","data","start","end","this","bp","dataEnd","chigh","clow","byteIn","ct","a","contexts","pos","cx_index","cx_mps","qeTableIcx","qeIcx","d"],"mappings":"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","file":"../arithmetic.js","sourcesContent":["define([\r\n    \"./codec\"\r\n], function(codec) {\r\n    //ref:pdfjs>src/core/arithmetic_decoder.js\r\n    'use strict';\r\n    const QeTable = [\r\n        {\r\n            qe: 22017,\r\n            nmps: 1,\r\n            nlps: 1,\r\n            switchFlag: 1\r\n        },\r\n        {\r\n            qe: 13313,\r\n            nmps: 2,\r\n            nlps: 6,\r\n            switchFlag: 0\r\n        },\r\n        {\r\n            qe: 6145,\r\n            nmps: 3,\r\n            nlps: 9,\r\n            switchFlag: 0\r\n        },\r\n        {\r\n            qe: 2753,\r\n            nmps: 4,\r\n            nlps: 12,\r\n            switchFlag: 0\r\n        },\r\n        {\r\n            qe: 1313,\r\n            nmps: 5,\r\n            nlps: 29,\r\n            switchFlag: 0\r\n        },\r\n        {\r\n            qe: 545,\r\n            nmps: 38,\r\n            nlps: 33,\r\n            switchFlag: 0\r\n        },\r\n        {\r\n            qe: 22017,\r\n            nmps: 7,\r\n            nlps: 6,\r\n            switchFlag: 1\r\n        },\r\n        {\r\n            qe: 21505,\r\n            nmps: 8,\r\n            nlps: 14,\r\n            switchFlag: 0\r\n        },\r\n        {\r\n            qe: 18433,\r\n            nmps: 9,\r\n            nlps: 14,\r\n            switchFlag: 0\r\n        },\r\n        {\r\n            qe: 14337,\r\n            nmps: 10,\r\n            nlps: 14,\r\n            switchFlag: 0\r\n        },\r\n        {\r\n            qe: 12289,\r\n            nmps: 11,\r\n            nlps: 17,\r\n            switchFlag: 0\r\n        },\r\n        {\r\n            qe: 9217,\r\n            nmps: 12,\r\n            nlps: 18,\r\n            switchFlag: 0\r\n        },\r\n        {\r\n            qe: 7169,\r\n            nmps: 13,\r\n            nlps: 20,\r\n            switchFlag: 0\r\n        },\r\n        {\r\n            qe: 5633,\r\n            nmps: 29,\r\n            nlps: 21,\r\n            switchFlag: 0\r\n        },\r\n        {\r\n            qe: 22017,\r\n            nmps: 15,\r\n            nlps: 14,\r\n            switchFlag: 1\r\n        },\r\n        {\r\n            qe: 21505,\r\n            nmps: 16,\r\n            nlps: 14,\r\n            switchFlag: 0\r\n        },\r\n        {\r\n            qe: 20737,\r\n            nmps: 17,\r\n            nlps: 15,\r\n            switchFlag: 0\r\n        },\r\n        {\r\n            qe: 18433,\r\n            nmps: 18,\r\n            nlps: 16,\r\n            switchFlag: 0\r\n        },\r\n        {\r\n            qe: 14337,\r\n            nmps: 19,\r\n            nlps: 17,\r\n            switchFlag: 0\r\n        },\r\n        {\r\n            qe: 13313,\r\n            nmps: 20,\r\n            nlps: 18,\r\n            switchFlag: 0\r\n        },\r\n        {\r\n            qe: 12289,\r\n            nmps: 21,\r\n            nlps: 19,\r\n            switchFlag: 0\r\n        },\r\n        {\r\n            qe: 10241,\r\n            nmps: 22,\r\n            nlps: 19,\r\n            switchFlag: 0\r\n        },\r\n        {\r\n            qe: 9217,\r\n            nmps: 23,\r\n            nlps: 20,\r\n            switchFlag: 0\r\n        },\r\n        {\r\n            qe: 8705,\r\n            nmps: 24,\r\n            nlps: 21,\r\n            switchFlag: 0\r\n        },\r\n        {\r\n            qe: 7169,\r\n            nmps: 25,\r\n            nlps: 22,\r\n            switchFlag: 0\r\n        },\r\n        {\r\n            qe: 6145,\r\n            nmps: 26,\r\n            nlps: 23,\r\n            switchFlag: 0\r\n        },\r\n        {\r\n            qe: 5633,\r\n            nmps: 27,\r\n            nlps: 24,\r\n            switchFlag: 0\r\n        },\r\n        {\r\n            qe: 5121,\r\n            nmps: 28,\r\n            nlps: 25,\r\n            switchFlag: 0\r\n        },\r\n        {\r\n            qe: 4609,\r\n            nmps: 29,\r\n            nlps: 26,\r\n            switchFlag: 0\r\n        },\r\n        {\r\n            qe: 4353,\r\n            nmps: 30,\r\n            nlps: 27,\r\n            switchFlag: 0\r\n        },\r\n        {\r\n            qe: 2753,\r\n            nmps: 31,\r\n            nlps: 28,\r\n            switchFlag: 0\r\n        },\r\n        {\r\n            qe: 2497,\r\n            nmps: 32,\r\n            nlps: 29,\r\n            switchFlag: 0\r\n        },\r\n        {\r\n            qe: 2209,\r\n            nmps: 33,\r\n            nlps: 30,\r\n            switchFlag: 0\r\n        },\r\n        {\r\n            qe: 1313,\r\n            nmps: 34,\r\n            nlps: 31,\r\n            switchFlag: 0\r\n        },\r\n        {\r\n            qe: 1089,\r\n            nmps: 35,\r\n            nlps: 32,\r\n            switchFlag: 0\r\n        },\r\n        {\r\n            qe: 673,\r\n            nmps: 36,\r\n            nlps: 33,\r\n            switchFlag: 0\r\n        },\r\n        {\r\n            qe: 545,\r\n            nmps: 37,\r\n            nlps: 34,\r\n            switchFlag: 0\r\n        },\r\n        {\r\n            qe: 321,\r\n            nmps: 38,\r\n            nlps: 35,\r\n            switchFlag: 0\r\n        },\r\n        {\r\n            qe: 273,\r\n            nmps: 39,\r\n            nlps: 36,\r\n            switchFlag: 0\r\n        },\r\n        {\r\n            qe: 133,\r\n            nmps: 40,\r\n            nlps: 37,\r\n            switchFlag: 0\r\n        },\r\n        {\r\n            qe: 73,\r\n            nmps: 41,\r\n            nlps: 38,\r\n            switchFlag: 0\r\n        },\r\n        {\r\n            qe: 37,\r\n            nmps: 42,\r\n            nlps: 39,\r\n            switchFlag: 0\r\n        },\r\n        {\r\n            qe: 21,\r\n            nmps: 43,\r\n            nlps: 40,\r\n            switchFlag: 0\r\n        },\r\n        {\r\n            qe: 9,\r\n            nmps: 44,\r\n            nlps: 41,\r\n            switchFlag: 0\r\n        },\r\n        {\r\n            qe: 5,\r\n            nmps: 45,\r\n            nlps: 42,\r\n            switchFlag: 0\r\n        },\r\n        {\r\n            qe: 1,\r\n            nmps: 45,\r\n            nlps: 43,\r\n            switchFlag: 0\r\n        },\r\n        {\r\n            qe: 22017,\r\n            nmps: 46,\r\n            nlps: 46,\r\n            switchFlag: 0\r\n        }\r\n    ];\r\n    class ArithmeticDecoder {\r\n        constructor(data, start, end) {\r\n            this.data = data;\r\n            this.bp = start;\r\n            this.dataEnd = end;\r\n            this.chigh = data[start];\r\n            this.clow = 0;\r\n            this.byteIn();\r\n            this.chigh = this.chigh << 7 & 65535 | this.clow >> 9 & 127;\r\n            this.clow = this.clow << 7 & 65535;\r\n            this.ct -= 7;\r\n            this.a = 32768;\r\n        }\r\n        byteIn() {\r\n            const data = this.data;\r\n            let bp = this.bp;\r\n            if (data[bp] === 255) {\r\n                if (data[bp + 1] > 143) {\r\n                    this.clow += 65280;\r\n                    this.ct = 8;\r\n                } else {\r\n                    bp++;\r\n                    this.clow += data[bp] << 9;\r\n                    this.ct = 7;\r\n                    this.bp = bp;\r\n                }\r\n            } else {\r\n                bp++;\r\n                this.clow += bp < this.dataEnd ? data[bp] << 8 : 65280;\r\n                this.ct = 8;\r\n                this.bp = bp;\r\n            }\r\n            if (this.clow > 65535) {\r\n                this.chigh += this.clow >> 16;\r\n                this.clow &= 65535;\r\n            }\r\n        }\r\n        readBit(contexts, pos) {\r\n            let cx_index = contexts[pos] >> 1, cx_mps = contexts[pos] & 1;\r\n            const qeTableIcx = QeTable[cx_index];\r\n            const qeIcx = qeTableIcx.qe;\r\n            let d;\r\n            let a = this.a - qeIcx;\r\n            if (this.chigh < qeIcx) {\r\n                if (a < qeIcx) {\r\n                    a = qeIcx;\r\n                    d = cx_mps;\r\n                    cx_index = qeTableIcx.nmps;\r\n                } else {\r\n                    a = qeIcx;\r\n                    d = 1 ^ cx_mps;\r\n                    if (qeTableIcx.switchFlag === 1) {\r\n                        cx_mps = d;\r\n                    }\r\n                    cx_index = qeTableIcx.nlps;\r\n                }\r\n            } else {\r\n                this.chigh -= qeIcx;\r\n                if ((a & 32768) !== 0) {\r\n                    this.a = a;\r\n                    return cx_mps;\r\n                }\r\n                if (a < qeIcx) {\r\n                    d = 1 ^ cx_mps;\r\n                    if (qeTableIcx.switchFlag === 1) {\r\n                        cx_mps = d;\r\n                    }\r\n                    cx_index = qeTableIcx.nlps;\r\n                } else {\r\n                    d = cx_mps;\r\n                    cx_index = qeTableIcx.nmps;\r\n                }\r\n            }\r\n            do {\r\n                if (this.ct === 0) {\r\n                    this.byteIn();\r\n                }\r\n                a <<= 1;\r\n                this.chigh = this.chigh << 1 & 65535 | this.clow >> 15 & 1;\r\n                this.clow = this.clow << 1 & 65535;\r\n                this.ct--;\r\n            } while ((a & 32768) === 0);\r\n            this.a = a;\r\n            contexts[pos] = cx_index << 1 | cx_mps;\r\n            return d;\r\n        }\r\n    }\r\n    return codec.arithmetic = { ArithmeticDecoder };\r\n});"]}